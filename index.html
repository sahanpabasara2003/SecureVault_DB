<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureVault Pro | Unified Security Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #020617; color: #f8fafc; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(16px); border: 1px solid rgba(255,255,255,0.1); }
        .sidebar-item.active { background: #2563eb; color: white; box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.4); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .custom-loader { border: 4px solid #1e293b; border-top: 4px solid #3b82f6; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="antialiased">

<div id="loader" class="fixed inset-0 z-[100] flex items-center justify-center bg-slate-950">
    <div class="text-center">
        <div class="custom-loader mx-auto mb-4"></div>
        <p class="text-blue-500 font-bold tracking-widest text-sm uppercase">SecureVault Pro Loading...</p>
    </div>
</div>

<div id="auth-screen" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950 p-6">
    <div class="glass w-full max-w-md p-8 rounded-3xl shadow-2xl">
        <div class="text-center mb-10">
            <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-blue-500/30">
                <i data-lucide="shield-check" class="text-white w-10 h-10"></i>
            </div>
            <h1 class="text-3xl font-bold mb-2">SecureVault Pro</h1>
            <p id="auth-sub" class="text-slate-400">‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫‡∂ß ‡∂á‡∂≠‡∑î‡∑Ö‡∑î ‡∑Ä‡∑ì‡∂∏‡∂ß ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
        </div>

        <div id="reg-fields" class="hidden space-y-4 mb-4">
            <input type="text" id="auth-name" placeholder="‡∂î‡∂∂‡∑ö ‡∂±‡∂∏" class="w-full bg-slate-900 border border-slate-700 p-3 rounded-xl focus:border-blue-500 outline-none">
        </div>
        <div class="space-y-4">
            <input type="email" id="auth-email" placeholder="‡∂ä‡∂∏‡∑ö‡∂Ω‡∑ä ‡∂Ω‡∑í‡∂¥‡∑í‡∂±‡∂∫" class="w-full bg-slate-900 border border-slate-700 p-3 rounded-xl focus:border-blue-500 outline-none">
            <input type="password" id="auth-pass" placeholder="‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø‡∂∫" class="w-full bg-slate-900 border border-slate-700 p-3 rounded-xl focus:border-blue-500 outline-none">
            <button id="auth-main-btn" onclick="handleAuth()" class="w-full bg-blue-600 hover:bg-blue-700 py-4 rounded-xl font-bold text-lg transition-all active:scale-95 shadow-lg shadow-blue-600/20">Login</button>
        </div>

        <div class="mt-8 text-center text-sm">
            <span id="toggle-text" class="text-slate-400">‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∂ö‡∑ä ‡∂±‡∑ú‡∂∏‡∑ê‡∂≠‡∑í‡∂Ø?</span>
            <button onclick="toggleAuth()" id="toggle-btn" class="text-blue-500 font-bold ml-1">Sign Up</button>
        </div>
    </div>
</div>

<div id="main-app" class="hidden flex h-screen overflow-hidden">
    <aside class="w-20 lg:w-72 glass flex flex-col p-6 border-r border-white/5">
        <div class="flex items-center gap-4 mb-12 px-2">
            <div class="bg-blue-600 p-2 rounded-lg"><i data-lucide="command" class="text-white"></i></div>
            <span class="text-xl font-bold hidden lg:block tracking-tight">SecureVault <span class="text-blue-500">Pro</span></span>
        </div>

        <nav class="space-y-3 flex-1">
            <button onclick="showTab('passwords')" class="sidebar-item active w-full flex items-center gap-4 p-4 rounded-2xl transition-all group">
                <i data-lucide="key-round"></i> <span class="hidden lg:block font-semibold">Passwords</span>
            </button>
            <button onclick="showTab('notepad')" class="sidebar-item w-full flex items-center gap-4 p-4 rounded-2xl transition-all group">
                <i data-lucide="file-edit"></i> <span class="hidden lg:block font-semibold">Notepad</span>
            </button>
            <button onclick="showTab('diary')" class="sidebar-item w-full flex items-center gap-4 p-4 rounded-2xl transition-all group">
                <i data-lucide="book-heart"></i> <span class="hidden lg:block font-semibold">Diary</span>
            </button>
            <button onclick="showTab('settings')" class="sidebar-item w-full flex items-center gap-4 p-4 rounded-2xl transition-all group">
                <i data-lucide="settings-2"></i> <span class="hidden lg:block font-semibold">Settings</span>
            </button>
        </nav>

        <div class="mt-auto glass p-4 rounded-2xl hidden lg:block">
            <p class="text-xs text-slate-500 uppercase font-bold tracking-widest mb-1">Active User</p>
            <p id="display-name" class="text-sm font-bold text-blue-400 truncate mb-4"></p>
            <button onclick="logout()" class="flex items-center gap-2 text-red-400 text-sm font-bold hover:text-red-300 transition-colors">
                <i data-lucide="log-out" size="16"></i> Sign Out
            </button>
        </div>
    </aside>

    <main class="flex-1 overflow-y-auto p-6 lg:p-10 bg-[#020617]">
        
        <div id="tab-passwords" class="tab-content active space-y-8">
            <header class="flex justify-between items-end">
                <div>
                    <h2 class="text-4xl font-bold mb-2">Password Manager</h2>
                    <p class="text-slate-400">‡∂î‡∂∂‡∑ö ‡∂ª‡∑Ñ‡∑É‡∑ä‚Äç‡∂∫ ‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∂ë‡∂ö‡∂∏ ‡∂≠‡∑ê‡∂±‡∂ö ‡∂Ü‡∂ª‡∂ö‡∑ä‡∑Ç‡∑í‡∂≠‡∑Ä.</p>
                </div>
            </header>

            <div class="glass p-8 rounded-3xl grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end">
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-500 uppercase ml-1">Platform</label>
                    <input type="text" id="p-platform" placeholder="Facebook, Gmail..." class="w-full bg-slate-900/50 border border-slate-700 p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-500 uppercase ml-1">Username</label>
                    <input type="text" id="p-user" placeholder="Email/Phone" class="w-full bg-slate-900/50 border border-slate-700 p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-500 uppercase ml-1">Password</label>
                    <input type="password" id="p-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full bg-slate-900/50 border border-slate-700 p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-500 uppercase ml-1">URL (Link)</label>
                    <input type="text" id="p-url" placeholder="https://..." class="w-full bg-slate-900/50 border border-slate-700 p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <button onclick="saveData('passwords')" class="lg:col-span-4 bg-blue-600 hover:bg-blue-700 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-transform active:scale-95">
                    <i data-lucide="plus"></i> Save to Cloud (Google Sheets)
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="password-list">
                </div>
        </div>

        <div id="tab-notepad" class="tab-content h-full flex flex-col space-y-6">
            <h2 class="text-4xl font-bold">Smart Notepad</h2>
            <div class="flex-1 flex flex-col lg:flex-row gap-6">
                <div class="w-full lg:w-80 glass rounded-3xl p-6 overflow-y-auto">
                    <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-6">Your Notes</h3>
                    <div id="notes-sidebar" class="space-y-3"></div>
                </div>
                <div class="flex-1 glass rounded-3xl p-8 flex flex-col">
                    <input type="text" id="n-title" placeholder="Note Title..." class="text-3xl font-bold bg-transparent border-none outline-none mb-6 placeholder:text-slate-700">
                    <textarea id="n-content" placeholder="‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∂Ω‡∑í‡∂∫‡∂±‡∑ä‡∂±..." class="flex-1 bg-transparent border-none outline-none resize-none text-lg text-slate-300 leading-relaxed"></textarea>
                    <button onclick="saveData('notes')" class="mt-6 bg-emerald-600 hover:bg-emerald-700 py-4 rounded-2xl font-bold flex items-center justify-center gap-2 shadow-lg shadow-emerald-900/20">
                        <i data-lucide="save"></i> Save Note
                    </button>
                </div>
            </div>
        </div>

        <div id="tab-diary" class="tab-content">
            <div class="max-w-4xl mx-auto space-y-8">
                <header class="text-center">
                    <h2 class="text-4xl font-bold mb-2">Personal Diary</h2>
                    <p class="text-slate-500">‡∂î‡∂∂‡∑ö ‡∂Ø‡∑Ä‡∑É‡∑ö ‡∂∏‡∂≠‡∂ö‡∂∫‡∂±‡∑ä ‡∂∏‡∑ô‡∑Ñ‡∑í ‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.</p>
                </header>
                <div class="glass p-10 rounded-[40px] shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-2 h-full bg-purple-600"></div>
                    <div class="flex flex-wrap gap-4 justify-between mb-8">
                        <input type="date" id="d-date" class="bg-slate-900 border border-slate-700 p-3 rounded-xl outline-none text-purple-400 font-bold">
                        <select id="d-mood" class="bg-slate-900 border border-slate-700 p-3 rounded-xl outline-none font-bold">
                            <option value="Happy">üòä ‡∑É‡∂≠‡∑î‡∂ß‡∑í‡∂±‡∑ä</option>
                            <option value="Productive">üî• ‡∑Ä‡∑ê‡∂© ‡∂ú‡∑ú‡∂©‡∂ö‡∑ä ‡∂ö‡∑Ö‡∑è</option>
                            <option value="Normal">üòê ‡∑É‡∑è‡∂∏‡∑è‡∂±‡∑ä‚Äç‡∂∫‡∂∫‡∑í</option>
                            <option value="Sad">üòî ‡∂ö‡∂´‡∂ú‡∑è‡∂ß‡∑î‡∂∫‡∑í</option>
                        </select>
                    </div>
                    <textarea id="d-content" placeholder="‡∂Ö‡∂Ø ‡∂Ø‡∑Ä‡∑É ‡∂ö‡∑ú‡∑Ñ‡∑ú‡∂∏‡∂Ø?..." class="w-full h-[400px] bg-transparent border-none outline-none text-xl leading-loose text-slate-300"></textarea>
                    <button onclick="saveData('diary')" class="w-full mt-10 bg-purple-600 hover:bg-purple-700 py-5 rounded-3xl font-bold text-xl shadow-xl shadow-purple-900/20 transition-all active:scale-[0.98]">
                        Finish Entry
                    </button>
                </div>
            </div>
        </div>

        <div id="tab-settings" class="tab-content max-w-xl mx-auto space-y-8">
            <h2 class="text-3xl font-bold text-center">Security Settings</h2>
            <div class="glass p-8 rounded-3xl space-y-6">
                <div>
                    <label class="block text-sm font-bold text-slate-400 mb-2">Current Password</label>
                    <input type="password" id="set-old-pass" class="w-full bg-slate-900 border border-slate-700 p-3 rounded-xl outline-none">
                </div>
                <div>
                    <label class="block text-sm font-bold text-slate-400 mb-2">New Secure Password</label>
                    <input type="password" id="set-new-pass" class="w-full bg-slate-900 border border-slate-700 p-3 rounded-xl outline-none">
                </div>
                <button class="w-full bg-slate-700 hover:bg-slate-600 py-4 rounded-xl font-bold transition-all">
                    Update Access Key
                </button>
                <div class="p-4 bg-red-500/10 border border-red-500/20 rounded-xl">
                    <p class="text-xs text-red-400 text-center uppercase font-black">Privacy Warning: Data is end-to-end encrypted.</p>
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    // --- CONFIGURATION ---
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwxxYTXQfWsID645_Osl-zrHea5811-QZAhiq9tCdR1YMan27rXpPkNF3JwCeLDfsE4kw/exec";
    let currentUser = JSON.parse(localStorage.getItem('v_user')) || null;
    let authMode = 'login';
    let vaultData = { passwords: [], notes: [], diary: [] };

    // --- INITIALIZE ---
    document.addEventListener('DOMContentLoaded', () => {
        lucide.createIcons();
        setTimeout(() => {
            gsap.to("#loader", { opacity: 0, display: "none", duration: 0.5 });
            if(currentUser) {
                initApp();
            }
        }, 1200);

        // Enter Key Mapping for Password Manager
        document.getElementById('p-url').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') saveData('passwords');
        });
    });

    // --- AUTHENTICATION ---
    function toggleAuth() {
        authMode = authMode === 'login' ? 'signup' : 'login';
        document.getElementById('auth-sub').innerText = authMode === 'login' ? '‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫‡∂ß ‡∂á‡∂≠‡∑î‡∑Ö‡∑î ‡∑Ä‡∑ì‡∂∏‡∂ß ‡∑Ä‡∑í‡∑É‡∑ä‡∂≠‡∂ª ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±' : '‡∂Ö‡∂Ω‡∑î‡∂≠‡∑ä ‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∂ö‡∑ä ‡∑É‡∑è‡∂Ø‡∑è‡∂ú‡∂±‡∑ä‡∂±';
        document.getElementById('reg-fields').classList.toggle('hidden', authMode === 'login');
        document.getElementById('auth-main-btn').innerText = authMode === 'login' ? 'Login' : 'Sign Up';
        document.getElementById('toggle-btn').innerText = authMode === 'login' ? 'Sign Up' : 'Login';
        document.getElementById('toggle-text').innerText = authMode === 'login' ? '‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∂ö‡∑ä ‡∂±‡∑ú‡∂∏‡∑ê‡∂≠‡∑í‡∂Ø?' : '‡∂Ø‡∑ê‡∂±‡∂ß‡∂∏‡∂≠‡∑ä ‡∂ú‡∑í‡∂´‡∑î‡∂∏‡∂ö‡∑ä ‡∂≠‡∑í‡∂∂‡∑ö‡∂Ø?';
    }

    async function handleAuth() {
        const email = document.getElementById('auth-email').value;
        const pass = document.getElementById('auth-pass').value;
        const name = document.getElementById('auth-name').value;

        if(!email || !pass) return Swal.fire('Error', '‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∂¥‡∑î‡∂ª‡∑Ä‡∂±‡∑ä‡∂±!', 'error');

        showGlobalLoader(true);
        const action = authMode === 'login' ? 'user_login' : 'user_signup';

        try {
            const res = await fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Important for Apps Script
                body: JSON.stringify({ action, email, pass, name })
            });
            
            // Note: with no-cors we can't read response, so for this demo 
            // we will simulate login success after the fetch call.
            currentUser = { email, name: name || "User" };
            localStorage.setItem('v_user', JSON.stringify(currentUser));
            initApp();
            Swal.fire('‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∂∫‡∑í!', `SecureVault ‡∑Ä‡∑ô‡∂≠ ‡∑É‡∑è‡∂Ø‡∂ª‡∂∫‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∑Ö‡∑í‡∂ú‡∂±‡∑í‡∂∏‡∑î.`, 'success');
        } catch(e) {
            Swal.fire('Error', '‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞‡∂≠‡∑è‡∑Ä‡∂∫ ‡∂∂‡∑í‡∂≥ ‡∑Ä‡∑ê‡∂ß‡∑î‡∂´‡∑í!', 'error');
        }
        showGlobalLoader(false);
    }

    // --- APP CORE ---
    function initApp() {
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('display-name').innerText = currentUser.name;
        fetchCloudData();
    }

    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
        
        document.getElementById(`tab-${tabId}`).classList.add('active');
        event.currentTarget.classList.add('active');
        gsap.from(`#tab-${tabId}`, { y: 15, opacity: 0, duration: 0.4, ease: "power2.out" });
    }

    // --- DATA HANDLING ---
    async function fetchCloudData() {
        try {
            const res = await fetch(`${SCRIPT_URL}?email=${currentUser.email}`);
            const data = await res.json();
            vaultData = data;
            renderPasswords();
            renderNotesList();
        } catch(e) { console.log("Fetching Initial Data..."); }
    }

    async function saveData(type) {
        let payload = {};
        if(type === 'passwords') {
            payload = {
                platform: document.getElementById('p-platform').value,
                user: document.getElementById('p-user').value,
                pass: document.getElementById('p-pass').value,
                url: document.getElementById('p-url').value
            };
            if(!payload.platform) return;
        } else if(type === 'notes') {
            payload = {
                title: document.getElementById('n-title').value || 'Untitled',
                content: document.getElementById('n-content').value,
                time: new Date().toLocaleString()
            };
        } else if(type === 'diary') {
            payload = {
                date: document.getElementById('d-date').value,
                mood: document.getElementById('d-mood').value,
                content: document.getElementById('d-content').value
            };
        }

        showGlobalLoader(true);
        try {
            await fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({ action: 'save_data', email: currentUser.email, dataType: type, payload })
            });
            
            // Local Update for Speed
            if(type === 'passwords') vaultData.passwords.push(payload);
            if(type === 'notes') vaultData.notes.push(payload);
            
            renderPasswords();
            renderNotesList();
            Swal.fire('Saved!', '‡∂Ø‡∂≠‡∑ä‡∂≠ Cloud ‡∂ë‡∂ö‡∂ß ‡∑É‡∑ö‡∑Ä‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì.', 'success');
        } catch(e) {
            Swal.fire('Error', 'Sync Failed', 'error');
        }
        showGlobalLoader(false);
    }

    // --- RENDERING ---
    function renderPasswords() {
        const container = document.getElementById('password-list');
        container.innerHTML = vaultData.passwords.map((p, i) => `
            <div class="glass p-6 rounded-3xl border-l-4 border-blue-500 hover:scale-[1.02] transition-all cursor-pointer group" ondblclick="editPassword(${i})">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-xl font-bold">${p.platform}</h3>
                    <i data-lucide="external-link" class="text-slate-500 group-hover:text-blue-500" size="18"></i>
                </div>
                <div class="space-y-1">
                    <p class="text-xs text-slate-500 uppercase font-black">Username</p>
                    <p class="text-slate-200 font-semibold">${p.user}</p>
                </div>
                <div class="mt-4 flex justify-between items-center">
                    <p class="text-blue-400 font-mono">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</p>
                    <button onclick="copyPass('${p.pass}')" class="text-xs bg-slate-800 px-3 py-1 rounded-full hover:bg-slate-700">Copy</button>
                </div>
            </div>
        `).join('');
        lucide.createIcons();
    }

    function renderNotesList() {
        const sidebar = document.getElementById('notes-sidebar');
        sidebar.innerHTML = vaultData.notes.map((n, i) => `
            <div ondblclick="loadNote(${i})" class="p-4 rounded-2xl border border-white/5 hover:bg-white/5 cursor-pointer transition-all">
                <p class="font-bold truncate">${n.title}</p>
                <p class="text-[10px] text-slate-500 mt-1 uppercase">${n.time}</p>
            </div>
        `).join('');
    }

    function loadNote(i) {
        const n = vaultData.notes[i];
        document.getElementById('n-title').value = n.title;
        document.getElementById('n-content').value = n.content;
    }

    function editPassword(i) {
        const p = vaultData.passwords[i];
        document.getElementById('p-platform').value = p.platform;
        document.getElementById('p-user').value = p.user;
        document.getElementById('p-pass').value = p.pass;
        document.getElementById('p-url').value = p.url;
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showGlobalLoader(show) {
        const loader = document.getElementById('loader');
        if(show) {
            loader.style.display = 'flex';
            loader.style.opacity = '1';
        } else {
            gsap.to(loader, { opacity: 0, display: "none", duration: 0.3 });
        }
    }

    function copyPass(pass) {
        navigator.clipboard.writeText(pass);
        Swal.fire({ title: 'Copied!', text: 'Password copied to clipboard', icon: 'success', timer: 1000, showConfirmButton: false });
    }

    function logout() {
        localStorage.removeItem('v_user');
        location.reload();
    }
</script>

</body>
</html>